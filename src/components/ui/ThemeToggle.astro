---
import Sun from './icons/Sun.astro';
import Moon from './icons/Moon.astro';
---

<button
  id="theme-toggle"
  class="bg-bg-secondary/50 hover:border-accent/50 relative flex h-10 w-10 items-center justify-center rounded-full border border-border transition-colors"
  aria-label="Toggle theme"
  type="button"
>
  <Sun
    class="sun-icon h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"
  />
  <Moon
    class="moon-icon absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"
  />
</button>

<script>
  function initThemeToggle() {
    const themeToggle = document.getElementById('theme-toggle');

    if (!themeToggle) return;

    themeToggle.addEventListener('click', () => {
      const isDark = document.documentElement.classList.contains('dark');

      if (isDark) {
        document.documentElement.classList.remove('dark');
        localStorage.setItem('theme', 'light');
      } else {
        document.documentElement.classList.add('dark');
        localStorage.setItem('theme', 'dark');
      }
    });
  }

  // Initialize on page load
  document.addEventListener('DOMContentLoaded', initThemeToggle);

  // Re-initialize after navigation (for SPAs)
  document.addEventListener('astro:after-swap', initThemeToggle);
</script>
