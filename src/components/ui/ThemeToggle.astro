---
import Sun from './icons/Sun.astro';
import Moon from './icons/Moon.astro';
---

<button
  class="theme-toggle-btn bg-bg-secondary/50 hover:border-accent/50 relative flex h-10 w-10 items-center justify-center rounded-full border border-border transition-colors"
  aria-label="Toggle theme"
  type="button"
>
  <Sun
    class="sun-icon h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"
  />
  <Moon
    class="moon-icon absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"
  />
</button>

<script>
  function toggleTheme() {
    const isDark = document.documentElement.classList.contains('dark');

    if (isDark) {
      document.documentElement.classList.remove('dark');
      localStorage.setItem('theme', 'light');
    } else {
      document.documentElement.classList.add('dark');
      localStorage.setItem('theme', 'dark');
    }
  }

  function initThemeToggle() {
    const themeToggles = document.querySelectorAll('.theme-toggle-btn');

    themeToggles.forEach((toggle) => {
      toggle.addEventListener('click', toggleTheme);
    });
  }

  // Initialize on page load and after view transitions
  document.addEventListener('astro:page-load', initThemeToggle);
</script>
