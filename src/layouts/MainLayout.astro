---
import '../styles/index.css';
import MainHead from '../components/MainHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import BackToTop from '../components/ui/BackToTop.astro';

// Modern fonts
import '@fontsource/playfair-display/400.css';
import '@fontsource/playfair-display/500.css';
import '@fontsource/playfair-display/600.css';
import '@fontsource/playfair-display/700.css';
import '@fontsource/dm-sans/400.css';
import '@fontsource/dm-sans/500.css';
import '@fontsource/dm-sans/600.css';
import '@fontsource/dm-sans/700.css';
import '@fontsource/outfit/400.css';
import '@fontsource/outfit/500.css';
import '@fontsource/outfit/600.css';
import '@fontsource/outfit/700.css';

interface OGData {
  title?: string;
  description?: string;
  image?: string;
}

interface Props {
  title?: string;
  structuredData?: object;
  meta?: string;
  liturgy?: boolean;
  ogData?: OGData;
}

const { title, meta, structuredData, liturgy, ogData } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <MainHead
      liturgy={liturgy}
      title={title}
      meta={meta}
      structuredData={structuredData}
      ogData={ogData}
    />

    <!-- Critical theme script to prevent flash -->
    <script is:inline>
      // Apply theme immediately
      function applyStoredTheme() {
        const theme = localStorage.getItem('theme');

        if (theme === 'dark') {
          document.documentElement.classList.add('dark');
        } else if (theme === 'light') {
          document.documentElement.classList.remove('dark');
        } else {
          // No theme set, use system preference
          const prefersDark = window.matchMedia(
            '(prefers-color-scheme: dark)'
          ).matches;
          if (prefersDark) {
            document.documentElement.classList.add('dark');
          } else {
            document.documentElement.classList.remove('dark');
          }
        }
      }

      // Apply on initial load
      applyStoredTheme();

      // Re-apply after view transitions (Astro navigation)
      document.addEventListener('astro:after-swap', applyStoredTheme);
    </script>
  </head>
  <body
    class="relative min-h-screen overflow-x-hidden bg-bg-primary font-bodyfont text-white"
  >
    <!-- Background effects -->
    <div class="fixed inset-0 -z-10 overflow-hidden">
      <!-- Gradient spotlight from top -->
      <div class="spotlight absolute inset-0"></div>

      <!-- Grid pattern -->
      <div class="grid-pattern absolute inset-0 opacity-50"></div>

      <!-- Ambient glow orbs - more subtle and refined -->
      <div
        class="absolute -left-32 top-0 h-[500px] w-[500px] rounded-full bg-accent/[0.03] blur-[100px] md:-left-20 md:h-[600px] md:w-[600px] md:blur-[120px]"
      >
      </div>
      <div
        class="absolute -right-32 top-1/3 h-[400px] w-[400px] rounded-full bg-accent/[0.04] blur-[100px] md:-right-20 md:h-[500px] md:w-[500px] md:blur-[130px]"
      >
      </div>
      <div
        class="absolute -bottom-32 left-1/4 h-[350px] w-[350px] rounded-full bg-accent/[0.02] blur-[80px] md:h-[400px] md:w-[400px] md:blur-[100px]"
      >
      </div>

      <!-- Additional subtle glow for depth -->
      <div
        class="absolute left-1/2 top-1/2 h-[300px] w-[800px] -translate-x-1/2 -translate-y-1/2 rounded-full bg-accent/[0.015] blur-[100px]"
      >
      </div>

      <!-- Noise overlay -->
      <div class="noise-overlay absolute inset-0"></div>
    </div>

    <!-- {!liturgy && <Header />} -->
    <Header />

    <main
      class="relative mx-auto my-10 min-h-screen max-w-6xl px-6 pt-10 md:my-16 lg:px-8 xl:px-0"
    >
      <slot />
    </main>

    <Footer />
    <BackToTop />
  </body>
</html>
